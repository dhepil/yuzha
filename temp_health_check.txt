// @ts-nocheck
#!/usr/bin/env node

const required = ['SUPABASE_URL', 'SUPABASE_ANON_KEY']
const missing = required.filter((key) => !process.env[key])
if (missing.length) {
  console.error('[health-check] Missing env vars:', missing.join(', '))
  console.error('Set them before running this script. Exiting with code 1.')
  process.exit(1)
}

const baseFunctionsUrl = process.env.SUPABASE_FUNCTIONS_BASE || `${process.env.SUPABASE_URL}/functions/v1`

const targets = [
  {
    name: 'user-hub-auth health',
    url: `${baseFunctionsUrl}/user-hub-auth/health`,
    method: 'GET'
  },
  {
    name: 'module-passkey health',
    url: `${baseFunctionsUrl}/module-passkey`,
    method: 'POST',
    init: {
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ moduleId: 'health', passkey: 'dummy' })
    }
  },
  {
    name: 'module-sync summary',
